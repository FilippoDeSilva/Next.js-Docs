name: Build Next.js Docs PDFs Pro

on:
  schedule:
    - cron: '0 0 * * *'
  workflow_dispatch:

jobs:
  build-pdfs:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Install Dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y nodejs npm git
          npm install -g puppeteer

      - name: Clone Next.js Docs
        run: |
          git clone --depth=1 --branch canary https://github.com/vercel/next.js.git nextjs-docs/canary
          git clone --depth=1 --branch latest https://github.com/vercel/next.js.git nextjs-docs/stable

      - name: Export Docs as Static HTML
        run: |
          # Example: Puppeteer script to crawl docs and save HTML
          node scripts/export-docs.js canary
          node scripts/export-docs.js stable

      - name: Generate PDFs
        run: |
          node scripts/html-to-pdf.js canary NextJS-Canary-Pro.pdf
          node scripts/html-to-pdf.js stable NextJS-Stable-Pro.pdf

      - name: Commit PDFs to Repo
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add pdf/
          git commit -m "Update Next.js Professional PDFs [skip ci]" || echo "No changes"
          git push